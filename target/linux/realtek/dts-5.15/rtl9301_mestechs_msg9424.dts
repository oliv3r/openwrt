// SPDX-License-Identifier: (GPL-2.0-or-later OR MIT)

/dts-v1/;

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/leds/leds-realtek.h>

#include "rtl9301.dtsi"
#include "rtl9301_common_24p.dtsi"

/ {
	compatible = "mestechs,msg9424", "realtek,rtl9301-soc", "realtek,rtl930x-soc";
	model = "Mestechs MSG9424 Switch";

	led_set {
		compatible = "realtek,rtl9301-leds", "realtek,rtl930x-leds";

		led_set0 = /bits/ 16 <
			/* LED0 */
			(
				RTL93XX_LED_SET_LINK_ACTIVITY |
				RTL93XX_LED_SET_LINK_UP_SOLID |
				RTL93XX_LED_SET_2P_1G_LINK |
				RTL93XX_LED_SET_1000M_LINK |
				RTL93XX_LED_SET_500M_LINK |
				RTL93XX_LED_SET_100M_LINK |
				RTL93XX_LED_SET_10M_LINK
			)
			/* LED1 */
			RTL93XX_LED_SET_NONE
			/* LED2 */
			RTL93XX_LED_SET_NONE
			/* LED3 */
			RTL93XX_LED_SET_NONE
		>;
		led_set1 = /bits/ 16 <
			/* LED0 */
			(
				RTL93XX_LED_SET_LINK_ACTIVITY |
				RTL93XX_LED_SET_LINK_UP_SOLID |
				RTL93XX_LED_SET_10G_LINK |
				RTL93XX_LED_SET_1000M_LINK
			)
			/* LED1 */
			RTL93XX_LED_SET_NONE
			/* LED2 */
			RTL93XX_LED_SET_NONE
			/* LED3 */
			RTL93XX_LED_SET_NONE
		>;
	};

	memory@0 {
		reg = <0x0 0x8000000>; /* 128 MiB */
		device_type = "memory";
	};

	sfp0: sfp0 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c0_0>;
		los-gpios = <&gpio0 13 GPIO_ACTIVE_HIGH>;
		tx-disable-gpios = <&gpio0 14 GPIO_ACTIVE_LOW>;
	};

	sfp1: sfp1 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c0_1>;
//		los-gpios = <&gpio0 15 GPIO_ACTIVE_HIGH>;
//		tx-disable-gpios = <&gpio0 16 GPIO_ACTIVE_LOW>;
	};

	sfp2: sfp2 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c0_2>;
//		los-gpios = <&gpio0 17 GPIO_ACTIVE_HIGH>;
//		tx-disable-gpios = <&gpio0 18 GPIO_ACTIVE_LOW>;
	};

	sfp3: sfp3 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c0_3>;
//		los-gpios = <&gpio0 19 GPIO_ACTIVE_HIGH>;
//		tx-disable-gpios = <&gpio0 20 GPIO_ACTIVE_LOW>;
	};
};

&i2c0 {
	status = "okay";
};

&i2c0_0 {
	status = "okay";
};

&i2c0_1 {
	status = "okay";
};

&i2c0_2 {
	status = "okay";
};

&i2c0_3 {
	status = "okay";
};

&qspif0 {
	status = "okay";

	flash@0 {
		reg = <0>;
		compatible = "winbond,w25q128jv", "jedec,spi-nor";
		spi-max-frequency = <133000000>;

		partitions: partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			partition@0 {
				reg = <0x0 0xe0000>;
				label = "u-boot";
				read-only;
			};

			partition@e0000 {
				reg = <0xe0000 0x10000>;
				label = "u-boot-env";
			};

			partition@f0000 {
				compatible = "openwrt,uimage", "denx,uimage";
				reg = <0xf0000 0xf10000>;
				label = "firmware";
				openwrt,ih-magic = <0x93010000>;
			};
		};
	};
};

&reset_button {
	gpios = <&gpio0 22 GPIO_ACTIVE_LOW>;

	status = "okay";
};

&switch0_ports {
	port@0 {
		reg = <0>;
		label = "lan1";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy0>;
		phy-mode = "qsgmii";
	};

	port@1 {
		reg = <1>;
		label = "lan2";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy1>;
		phy-mode = "qsgmii";
	};

	port@2 {
		reg = <2>;
		label = "lan3";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy2>;
		phy-mode = "qsgmii";
	};

	port@3 {
		reg = <3>;
		label = "lan4";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy3>;
		phy-mode = "qsgmii";
	};

	port@4 {
		reg = <4>;
		label = "lan5";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy4>;
		phy-mode = "qsgmii";
	};

	port@5 {
		reg = <5>;
		label = "lan6";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy5>;
		phy-mode = "qsgmii";
	};

	port@6 {
		reg = <6>;
		label = "lan7";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy6>;
		phy-mode = "qsgmii";
	};

	port@7 {
		reg = <7>;
		label = "lan8";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy7>;
		phy-mode = "qsgmii";
	};

	port@8 {
		reg = <8>;
		label = "lan9";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy8>;
		phy-mode = "xgmii";
	};

	port@9 {
		reg = <9>;
		label = "lan10";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy9>;
		phy-mode = "xgmii";
	};

	port@10 {
		reg = <10>;
		label = "lan11";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy10>;
		phy-mode = "xgmii";
	};

	port@11 {
		reg = <11>;
		label = "lan12";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy11>;
		phy-mode = "xgmii";
	};

	port@12 {
		reg = <12>;
		label = "lan13";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy12>;
		phy-mode = "xgmii";
	};

	port@13 {
		reg = <13>;
		label = "lan14";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy13>;
		phy-mode = "xgmii";
	};

	port@14 {
		reg = <14>;
		label = "lan15";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy14>;
		phy-mode = "xgmii";
	};

	port@15 {
		reg = <15>;
		label = "lan16";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy15>;
		phy-mode = "xgmii";
	};

	port@16 {
		reg = <16>;
		label = "lan17";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy16>;
		phy-mode = "xgmii";
	};

	port@17 {
		reg = <17>;
		label = "lan18";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy17>;
		phy-mode = "xgmii";
	};

	port@18 {
		reg = <18>;
		label = "lan19";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy18>;
		phy-mode = "xgmii";
	};

	port@19 {
		reg = <19>;
		label = "lan20";
		led-set = <0>;
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		phy-handle = <&phy19>;
		phy-mode = "xgmii";
	};

	port@20 {
		reg = <20>;
		label = "lan21";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy20>;
		phy-mode = "xgmii";
	};

	port@21 {
		reg = <21>;
		label = "lan22";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy21>;
		phy-mode = "xgmii";
	};

	port@22 {
		reg = <22>;
		label = "lan23";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy22>;
		phy-mode = "xgmii";
	};

	port@23 {
		reg = <23>;
		label = "lan24";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <0>;
		phy-handle = <&phy23>;
		phy-mode = "xgmii";
	};

	port@24 {
		reg = <24>;
		label = "lan25";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <1>;
		phy-handle = <&phy24>;
		phy-mode = "10gbase-r";
		managed = "in-band-status";
		sfp = <&sfp0>;
	};

	port@25 {
		reg = <25>;
		label = "lan26";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <1>;
		phy-handle = <&phy25>;
		phy-mode = "10gbase-r";
		managed = "in-band-status";
		sfp = <&sfp1>;
	};

	port@26 {
		reg = <26>;
		label = "lan27";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <1>;
		phy-handle = <&phy26>;
		phy-mode = "10gbase-r";
		managed = "in-band-status";
		sfp = <&sfp2>;
	};

	port@27 {
		reg = <27>;
		label = "lan28";
		led-num = <(
			RTL93XX_LED_NUM0 /* Lime */
		)>;
		led-set = <1>;
		phy-handle = <&phy27>;
		phy-mode = "10gbase-r";
		managed = "in-band-status";
		sfp = <&sfp3>;
	};
};

&sys_led {
	status = "okay";
};
